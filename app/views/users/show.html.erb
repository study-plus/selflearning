<h1>マイページ</h1>
<p>名前 : <%= @user.name %></p>
<p>メールアドレス : <%= @user.email %></p>
<p>プロフィール : <%= @user.profile %></p>
<%= render "relationships/follow_button", user: @user %>
<% if current_user.id == @user.id %>
    <%= link_to "編集する", edit_user_registration_path %>
    <h2>あなたの予定</h2>
    <table>
        <thead>
            <tr>
                <th>タイトル</th>
                <th>時間</th>
                <th colspan="3"></th>
            </tr>
        </thead>

        <tbody>
            <% @events.each do |event| %>
                <tr>
                    <td><%= event.title%></td>
                    <td><%= event.start.strftime("%Y-%m-%d %H:%M") %>~</td>
                    <td><%= event.end.strftime("%Y-%m-%d %H:%M") %></td>
                    <td><%= link_to "Show", user_event_path(event.user_id, event.id) %></td>
                    <td><%= link_to "Edit", edit_user_event_path(@user.id,event.id) %></td>
                    <td><%= link_to "Destroy", user_event_path(event.id), method: :dlete, data: {confirm: 'Are you sure?'} %></td>
                </tr>
            <% end %>
        </tbody>
    </table>
    <br>
    <%= link_to "予定を追加する", "/users/#{@user.id}/events/new" %>

    <%= month_calendar events: @events do |date, events| %>
        <%= date.day %>

        <% events.each do |event| %>
            <div>
                <%= link_to event.title, user_event_path(event.id) %>
            </div>
        <% end %>
    <% end %>
<% else %>
    <% if @isRoom == true %>
        <a href="/rooms/<%= @roomId %>">チャットへ</a>
    <% else %>
        <%= form_for @room do |f| %>
            <%= fields_for @entry do |e| %>
                <%= e.hidden_field :user_id, :value=> @user.id %>
            <% end %>
            <%= f.submit "チャットを始める" %>
        <% end %>
    <% end %>
<% end %>

<h2>勉強時間</h2>
<%= column_chart Post.pluck(:created_at, :total) %>

<h2>ユーザーの投稿一覧</h2>
<% @user.posts.each do |t| %>
    <%= t.user.name %>
    <%= t.content %>
<% end %>

<!-- 以下はいいね機能を実装している場合-->
<h2>ユーザーがいいねした投稿一覧</h2>
<% @user.liked_posts.each do |t| %>
    <%= t.user.name %>
    <%= t.content %>
<% end %>
<!-- ここまで-->
<br>
<%= link_to "投稿一覧に戻る", posts_path %>
<%= link_to "ユーザー一覧に戻る", user_index_path %>